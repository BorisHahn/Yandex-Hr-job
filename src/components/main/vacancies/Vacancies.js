import { useEffect, useState } from 'react'
import Vacancy from './vacancy/Vacancy'
import data from '../../../utils/bd-mentor.json'

const Vacancies = () => {
  const [dataBase, setDataBase] = useState([])
  const [start, setStart] = useState(false)
  const [activeJobMentor, setActiveJobMentor] = useState(true)
  const [activeDirection, setActiveDirection] = useState(0)
  const [cardOnPage, setCardOnPage] = useState(12)
  const [hiddenButton, setHiddenButton] = useState(true)

  useEffect(() => {
    setStart(true)
    setDataBase(data.programming)
    checkHiddenButton(data.programming)
  }, [])

  const addCard = () => {
    let numberAllCardOnPage = cardOnPage + 3
    if (numberAllCardOnPage >= dataBase.length) {
      setHiddenButton(false)
    }
    setCardOnPage(numberAllCardOnPage)
  }

  const handleDirection = (numberElement, mentorDirection, reviewDirection) => {
    setActiveDirection(numberElement)
    if (activeJobMentor === true) {
      setDataBase(mentorDirection)
      checkHiddenButton(mentorDirection)
    } else {
      setDataBase(reviewDirection)
      checkHiddenButton(reviewDirection)
    }
  }

  const checkHiddenButton = (direction) => {
    direction.length > cardOnPage ? setHiddenButton(true) : setHiddenButton(false)
  }

  return (
    <section className='vacancies'>
      <h2 className='vacancies__title font_display'>–û—Ç–∫—Ä—ã—Ç—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</h2>
      <ul className='vacancies__job-container'>
        <li
          onClick={() => {
            setActiveJobMentor(true)
            setDataBase(data.programming)
            setActiveDirection(0)
          }}
          className={activeJobMentor ? 'vacancies__job vacancies__job_active' : 'vacancies__job'}
        >
          –î–ª—è –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–æ–≤
        </li>
        <li
          onClick={() => {
            setActiveJobMentor(false)
            setDataBase(data.programmingReview)
            setActiveDirection(0)
          }}
          className={activeJobMentor ? 'vacancies__job' : 'vacancies__job vacancies__job_active'}
        >
          –î–ª—è —Ä–µ–≤—å—é–µ—Ä–æ–≤
        </li>
      </ul>
      <div className='vacancies__block-direction'>
        <ul className='vacancies__direction-container'>
          <li
            onClick={() => handleDirection(0, data.programming, data.programmingReview)}
            className={
              activeDirection === 0 ? 'vacancies__direction vacancies__direction_active' : 'vacancies__direction'
            }
          >
            –ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ
          </li>
          <li
            onClick={() => handleDirection(1, data.analytics, data.analyticsReview)}
            className={
              activeDirection === 1 ? 'vacancies__direction vacancies__direction_active' : 'vacancies__direction'
            }
          >
            –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
          </li>
          <li
            onClick={() => handleDirection(2, data.design, data.designReview)}
            className={
              activeDirection === 2 ? 'vacancies__direction vacancies__direction_active' : 'vacancies__direction'
            }
          >
            –î–∏–∑–∞–π–Ω
          </li>
          <li
            onClick={() => handleDirection(3, data.marketing, data.marketingReview)}
            className={
              activeDirection === 3 ? 'vacancies__direction vacancies__direction_active' : 'vacancies__direction'
            }
          >
            –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥
          </li>
          <li
            onClick={() => handleDirection(4, data.management, data.managementReview)}
            className={
              activeDirection === 4 ? 'vacancies__direction vacancies__direction_active' : 'vacancies__direction'
            }
          >
            –ú–µ–Ω–µ–¥–∂–º–µ–Ω
          </li>
        </ul>
        <div className='vacancies__new-vacancy'>
          <div className='vacancies__new-vacancy-logo'></div>
          <p className='vacancies__new-vacancy-text'>–ù–æ–≤—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</p>
        </div>
      </div>

      {dataBase.length ? (
        <ul className='vacancies__container'>
          {start ? dataBase.slice(0, cardOnPage).map((element) => <Vacancy card={element} key={element.id} />) : ''}
        </ul>
      ) : (
        <div>
          <p className='vacancies__not-vacancy-text'>–¢–∞–∫–∏—Ö –≤–∞–∫–∞–Ω—Å–∏–π –ø–æ–∫–∞ –Ω–µ—Ç üòä</p>
          <p className='vacancies__not-vacancy-text'>–ß—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥—Ä—É–≥–∏–µ, –ø–æ–º–µ–Ω—è–π—Ç–µ —Ä–æ–ª—å –∏–ª–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ.</p>
        </div>
      )}

      <p
        onClick={addCard}
        className={hiddenButton ? 'vacancies__button' : 'vacancies__button vacancies__button_hidden'}
      >
        –ü–æ–∫–∞–∑–∞—Ç—å –±–æ–ª—å—à–µ
      </p>
    </section>
  )
}

export default Vacancies
